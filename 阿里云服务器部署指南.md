# é˜¿é‡Œäº‘æœåŠ¡å™¨éƒ¨ç½²æŒ‡å—

## ğŸ“‹ ç›®å½•

1. [æœåŠ¡å™¨å‡†å¤‡](#æœåŠ¡å™¨å‡†å¤‡)
2. [ç¯å¢ƒå®‰è£…](#ç¯å¢ƒå®‰è£…)
3. [é¡¹ç›®éƒ¨ç½²](#é¡¹ç›®éƒ¨ç½²)
4. [åŸŸåå’ŒSSLé…ç½®](#åŸŸåå’Œsslé…ç½®)
5. [å®‰å…¨é…ç½®](#å®‰å…¨é…ç½®)
6. [ç›‘æ§å’Œç»´æŠ¤](#ç›‘æ§å’Œç»´æŠ¤)
7. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## æœåŠ¡å™¨å‡†å¤‡

### 1. è´­ä¹°é˜¿é‡Œäº‘ECSæœåŠ¡å™¨

**æ¨èé…ç½®**ï¼š
- **å®ä¾‹è§„æ ¼**: ecs.c6.largeï¼ˆ2æ ¸4GBï¼‰æˆ–æ›´é«˜
- **æ“ä½œç³»ç»Ÿ**: Ubuntu 22.04 LTS æˆ– CentOS 8
- **å­˜å‚¨**: 40GBç³»ç»Ÿç›˜ + 20GBæ•°æ®ç›˜
- **å¸¦å®½**: 5Mbpsæˆ–æ›´é«˜
- **åœ°åŸŸ**: æ ¹æ®ç”¨æˆ·ä½ç½®é€‰æ‹©ï¼ˆå¦‚åä¸œã€ååŒ—ï¼‰

### 2. é…ç½®å®‰å…¨ç»„è§„åˆ™

åœ¨é˜¿é‡Œäº‘æ§åˆ¶å°é…ç½®å®‰å…¨ç»„ï¼Œå¼€æ”¾ä»¥ä¸‹ç«¯å£ï¼š

| ç«¯å£ | åè®® | è¯´æ˜ | æˆæƒå¯¹è±¡ |
|------|------|------|----------|
| 22 | TCP | SSHç™»å½• | ä½ çš„IPåœ°å€ |
| 80 | TCP | HTTP | 0.0.0.0/0 |
| 443 | TCP | HTTPS | 0.0.0.0/0 |
| 8000 | TCP | åº”ç”¨ç«¯å£ï¼ˆå¯é€‰ï¼‰ | 0.0.0.0/0 |

**æ³¨æ„**ï¼š
- å»ºè®®é™åˆ¶SSHç«¯å£(22)åªå…è®¸ç‰¹å®šIPè®¿é—®
- 3306ç«¯å£ï¼ˆMySQLï¼‰ä¸è¦å¯¹å¤–å¼€æ”¾

### 3. è¿æ¥åˆ°æœåŠ¡å™¨

```bash
# ä½¿ç”¨SSHè¿æ¥ï¼ˆWindowsç”¨æˆ·å¯ä»¥ä½¿ç”¨PuTTYæˆ–Windows Terminalï¼‰
ssh root@your_server_ip

# é¦–æ¬¡ç™»å½•åï¼Œå»ºè®®ä¿®æ”¹rootå¯†ç 
passwd
```

---

## ç¯å¢ƒå®‰è£…

### æ–¹æ¡ˆA: ä½¿ç”¨Dockeréƒ¨ç½²ï¼ˆæ¨èï¼‰â­â­â­â­â­

#### 1. æ›´æ–°ç³»ç»Ÿ

```bash
# Ubuntuç³»ç»Ÿ
apt update && apt upgrade -y

# CentOSç³»ç»Ÿ
yum update -y
```

#### 2. å®‰è£…Docker

```bash
# Ubuntuç³»ç»Ÿ
# å®‰è£…ä¾èµ–
apt install -y apt-transport-https ca-certificates curl software-properties-common

# æ·»åŠ Dockerå®˜æ–¹GPGå¯†é’¥
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | apt-key add -

# æ·»åŠ Dockerä»“åº“
add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"

# å®‰è£…Docker
apt update
apt install -y docker-ce docker-ce-cli containerd.io

# å¯åŠ¨Docker
systemctl start docker
systemctl enable docker

# éªŒè¯å®‰è£…
docker --version
```

```bash
# CentOSç³»ç»Ÿ
# å®‰è£…ä¾èµ–
yum install -y yum-utils device-mapper-persistent-data lvm2

# æ·»åŠ Dockerä»“åº“
yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo

# å®‰è£…Docker
yum install -y docker-ce docker-ce-cli containerd.io

# å¯åŠ¨Docker
systemctl start docker
systemctl enable docker

# éªŒè¯å®‰è£…
docker --version
```

#### 3. å®‰è£…Docker Compose

**æ–¹æ³•1: ä½¿ç”¨å›½å†…é•œåƒï¼ˆæ¨èï¼Œé¿å…GitHubè®¿é—®é—®é¢˜ï¼‰**
```bash
# ä½¿ç”¨DaoCloudé•œåƒï¼ˆæ¨èï¼‰
curl -L "https://get.daocloud.io/docker/compose/releases/download/v2.23.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose

# æ·»åŠ æ‰§è¡Œæƒé™
chmod +x /usr/local/bin/docker-compose

# éªŒè¯å®‰è£…
docker-compose --version
```

**æ–¹æ³•2: ä½¿ç”¨åŒ…ç®¡ç†å™¨ï¼ˆæœ€ç®€å•ï¼‰**
```bash
# Ubuntu
apt install -y docker-compose

# CentOS
yum install -y epel-release && yum install -y docker-compose

# éªŒè¯å®‰è£…
docker-compose --version
```

**æ–¹æ³•3: ä»GitHubä¸‹è½½ï¼ˆå¦‚æœèƒ½è®¿é—®GitHubï¼‰**
```bash
# ä¸‹è½½Docker Compose
curl -L "https://github.com/docker/compose/releases/download/v2.23.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose

# æ·»åŠ æ‰§è¡Œæƒé™
chmod +x /usr/local/bin/docker-compose

# éªŒè¯å®‰è£…
docker-compose --version
```

**å¦‚æœé‡åˆ°GitHubè®¿é—®é—®é¢˜**ï¼Œè¯·æŸ¥çœ‹ï¼š[GitHubè®¿é—®é—®é¢˜è§£å†³æ–¹æ¡ˆ.md](GitHubè®¿é—®é—®é¢˜è§£å†³æ–¹æ¡ˆ.md)

#### 4. å®‰è£…Git

```bash
# Ubuntu
apt install -y git

# CentOS
yum install -y git

# éªŒè¯å®‰è£…
git --version
```

---

### æ–¹æ¡ˆB: ç›´æ¥å®‰è£…ï¼ˆä¸ä½¿ç”¨Dockerï¼‰

#### 1. å®‰è£…Python 3.11

```bash
# Ubuntuç³»ç»Ÿ
apt install -y software-properties-common
add-apt-repository ppa:deadsnakes/ppa
apt update
apt install -y python3.11 python3.11-venv python3.11-dev

# è®¾ç½®Python 3.11ä¸ºé»˜è®¤ç‰ˆæœ¬
update-alternatives --install /usr/bin/python3 python3 /usr/bin/python3.11 1

# å®‰è£…pip
apt install -y python3-pip
```

#### 2. å®‰è£…MySQL 8.0

```bash
# Ubuntuç³»ç»Ÿ
apt install -y mysql-server mysql-client

# å¯åŠ¨MySQL
systemctl start mysql
systemctl enable mysql

# å®‰å…¨é…ç½®
mysql_secure_installation
```

#### 3. å®‰è£…Nginx

```bash
# Ubuntuç³»ç»Ÿ
apt install -y nginx

# å¯åŠ¨Nginx
systemctl start nginx
systemctl enable nginx
```

---

## é¡¹ç›®éƒ¨ç½²

### ä½¿ç”¨Dockeréƒ¨ç½²ï¼ˆæ¨èï¼‰

#### 1. ä¸Šä¼ é¡¹ç›®åˆ°æœåŠ¡å™¨

**æ–¹æ³•1: ä½¿ç”¨Gitï¼ˆæ¨èï¼‰**
```bash
# å¦‚æœé¡¹ç›®åœ¨GitHub/GitLabä¸Š
cd /opt
git clone https://github.com/your-username/sf-express.git
cd sf-express
```

**æ–¹æ³•2: ä½¿ç”¨SCPä¸Šä¼ **
```bash
# åœ¨æœ¬åœ°ç”µè„‘ä¸Šæ‰§è¡Œï¼ˆWindowsç”¨æˆ·å¯ä»¥ä½¿ç”¨WinSCPï¼‰
# å…ˆæ‰“åŒ…é¡¹ç›®
cd sf-express
tar -czf sf-express.tar.gz .

# ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp sf-express.tar.gz root@your_server_ip:/opt/

# åœ¨æœåŠ¡å™¨ä¸Šè§£å‹
ssh root@your_server_ip
cd /opt
tar -xzf sf-express.tar.gz
mv sf-express /opt/sf-express
cd /opt/sf-express
```

#### 2. é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶ç¯å¢ƒé…ç½®æ¨¡æ¿
cp .env.example .env.production

# ç¼–è¾‘é…ç½®æ–‡ä»¶
nano .env.production
```

**é‡è¦é…ç½®é¡¹**ï¼š
```env
# MySQLé…ç½®
MYSQL_ROOT_PASSWORD=your_strong_root_password_here
MYSQL_PASSWORD=your_strong_user_password_here

# JWTå¯†é’¥ï¼ˆå¿…é¡»ä¿®æ”¹ï¼ï¼‰
SECRET_KEY=your_very_strong_secret_key_at_least_32_characters_long

# å¿«é€’100 APIé…ç½®ï¼ˆä½¿ç”¨ä½ çš„çœŸå®é…ç½®ï¼‰
KUAIDI100_KEY=fypLxFrg3636
KUAIDI100_CUSTOMER=3564B6CF145FA93724CE18C1FB149036
KUAIDI100_SECRET=8fa1052ba57e4d9ca0427938a77e2e30
KUAIDI100_USERID=a1ffc21f3de94cf5bdd908faf3bbc81d

# Rediså¯†ç 
REDIS_PASSWORD=your_redis_password_here

# æ—¥å¿—çº§åˆ«
LOG_LEVEL=INFO
```

**ç”Ÿæˆå¼ºå¯†é’¥**ï¼š
```bash
# ç”ŸæˆSECRET_KEY
python3 -c "import secrets; print(secrets.token_urlsafe(32))"
```

#### 3. åˆ›å»ºå¿…è¦çš„ç›®å½•

```bash
# åˆ›å»ºæ•°æ®ç›®å½•
mkdir -p /opt/sf-express/uploads
mkdir -p /opt/sf-express/logs
mkdir -p /opt/sf-express/docker/nginx/ssl

# è®¾ç½®æƒé™
chmod 755 /opt/sf-express/uploads
chmod 755 /opt/sf-express/logs
```

#### 4. ç”ŸæˆSSLè¯ä¹¦ï¼ˆä¸´æ—¶è‡ªç­¾åï¼‰

```bash
# ç”Ÿæˆè‡ªç­¾åè¯ä¹¦ï¼ˆç”¨äºæµ‹è¯•ï¼‰
openssl req -x509 -nodes -days 365 -newkey rsa:2048 \
    -keyout /opt/sf-express/docker/nginx/ssl/key.pem \
    -out /opt/sf-express/docker/nginx/ssl/cert.pem \
    -subj "/C=CN/ST=Beijing/L=Beijing/O=SF Express/CN=yourdomain.com"
```

**æ³¨æ„**ï¼šç”Ÿäº§ç¯å¢ƒå»ºè®®ä½¿ç”¨çœŸå®çš„SSLè¯ä¹¦ï¼ˆè§åæ–‡ï¼‰

#### 5. å¯åŠ¨æœåŠ¡

```bash
# æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
cd /opt/sf-express
docker-compose --env-file .env.production up -d --build

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose --env-file .env.production ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose --env-file .env.production logs -f
```

#### 6. åˆå§‹åŒ–æ•°æ®åº“

```bash
# ç­‰å¾…æ•°æ®åº“å¯åŠ¨ï¼ˆçº¦30ç§’ï¼‰
sleep 30

# è¿è¡Œæ•°æ®åº“è¿ç§»
docker-compose --env-file .env.production exec app alembic upgrade head

# åˆ›å»ºç®¡ç†å‘˜è´¦å·
docker-compose --env-file .env.production exec app python create_admin_user.py
```

#### 7. éªŒè¯éƒ¨ç½²

```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
docker-compose --env-file .env.production ps

# æµ‹è¯•API
curl http://localhost:8000/health

# æµ‹è¯•å‰ç«¯
curl http://localhost
```

---

### ç›´æ¥éƒ¨ç½²ï¼ˆä¸ä½¿ç”¨Dockerï¼‰

#### 1. ä¸Šä¼ é¡¹ç›®

```bash
# ä¸Šä¼ åˆ°æœåŠ¡å™¨
cd /opt
# ä½¿ç”¨gitæˆ–scpä¸Šä¼ é¡¹ç›®
```

#### 2. å®‰è£…Pythonä¾èµ–

```bash
cd /opt/sf-express

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3 -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

#### 3. é…ç½®æ•°æ®åº“

```bash
# ç™»å½•MySQL
mysql -u root -p

# åˆ›å»ºæ•°æ®åº“å’Œç”¨æˆ·
CREATE DATABASE express_tracking CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER 'express_user'@'localhost' IDENTIFIED BY 'your_password';
GRANT ALL PRIVILEGES ON express_tracking.* TO 'express_user'@'localhost';
FLUSH PRIVILEGES;
EXIT;
```

#### 4. é…ç½®ç¯å¢ƒå˜é‡

```bash
# å¤åˆ¶é…ç½®æ–‡ä»¶
cp .env.example .env

# ç¼–è¾‘é…ç½®
nano .env
```

ä¿®æ”¹ä¸ºï¼š
```env
DATABASE_URL=mysql+pymysql://express_user:your_password@localhost:3306/express_tracking
SECRET_KEY=your_generated_secret_key
# ... å…¶ä»–é…ç½®
```

#### 5. åˆå§‹åŒ–æ•°æ®åº“

```bash
# è¿è¡Œè¿ç§»
alembic upgrade head

# åˆ›å»ºç®¡ç†å‘˜
python create_admin_user.py
```

#### 6. é…ç½®SystemdæœåŠ¡

```bash
# åˆ›å»ºæœåŠ¡æ–‡ä»¶
nano /etc/systemd/system/sf-express.service
```

å†…å®¹ï¼š
```ini
[Unit]
Description=SF Express Tracking Service
After=network.target mysql.service

[Service]
Type=simple
User=root
WorkingDirectory=/opt/sf-express
Environment="PATH=/opt/sf-express/venv/bin"
ExecStart=/opt/sf-express/venv/bin/uvicorn app.main:app --host 0.0.0.0 --port 8000 --workers 4
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

å¯åŠ¨æœåŠ¡ï¼š
```bash
# é‡è½½systemd
systemctl daemon-reload

# å¯åŠ¨æœåŠ¡
systemctl start sf-express
systemctl enable sf-express

# æŸ¥çœ‹çŠ¶æ€
systemctl status sf-express
```

#### 7. é…ç½®Nginx

```bash
# åˆ›å»ºNginxé…ç½®
nano /etc/nginx/sites-available/sf-express
```

å†…å®¹ï¼š
```nginx
server {
    listen 80;
    server_name your_domain.com;

    client_max_body_size 10M;

    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    location /static {
        alias /opt/sf-express/static;
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
}
```

å¯ç”¨é…ç½®ï¼š
```bash
# åˆ›å»ºè½¯é“¾æ¥
ln -s /etc/nginx/sites-available/sf-express /etc/nginx/sites-enabled/

# æµ‹è¯•é…ç½®
nginx -t

# é‡å¯Nginx
systemctl restart nginx
```

---

## åŸŸåå’ŒSSLé…ç½®

### 1. é…ç½®åŸŸåè§£æ

åœ¨é˜¿é‡Œäº‘åŸŸåæ§åˆ¶å°æ·»åŠ Aè®°å½•ï¼š
- **è®°å½•ç±»å‹**: A
- **ä¸»æœºè®°å½•**: @ æˆ– www
- **è®°å½•å€¼**: ä½ çš„æœåŠ¡å™¨IPåœ°å€
- **TTL**: 10åˆ†é’Ÿ

### 2. å®‰è£…Let's Encrypt SSLè¯ä¹¦ï¼ˆå…è´¹ï¼‰

```bash
# å®‰è£…certbot
apt install -y certbot python3-certbot-nginx

# è·å–è¯ä¹¦ï¼ˆä½¿ç”¨Nginxæ’ä»¶ï¼‰
certbot --nginx -d yourdomain.com -d www.yourdomain.com

# è‡ªåŠ¨ç»­æœŸ
certbot renew --dry-run
```

### 3. é…ç½®SSLè¯ä¹¦ï¼ˆDockeréƒ¨ç½²ï¼‰

```bash
# å¤åˆ¶è¯ä¹¦åˆ°é¡¹ç›®ç›®å½•
cp /etc/letsencrypt/live/yourdomain.com/fullchain.pem /opt/sf-express/docker/nginx/ssl/cert.pem
cp /etc/letsencrypt/live/yourdomain.com/privkey.pem /opt/sf-express/docker/nginx/ssl/key.pem

# é‡å¯Nginx
docker-compose --env-file .env.production restart nginx
```

### 4. è®¾ç½®è‡ªåŠ¨ç»­æœŸ

```bash
# æ·»åŠ å®šæ—¶ä»»åŠ¡
crontab -e

# æ·»åŠ ä»¥ä¸‹è¡Œï¼ˆæ¯å¤©å‡Œæ™¨2ç‚¹æ£€æŸ¥å¹¶ç»­æœŸï¼‰
0 2 * * * certbot renew --quiet && docker-compose -f /opt/sf-express/docker-compose.yml --env-file /opt/sf-express/.env.production restart nginx
```

---

## å®‰å…¨é…ç½®

### 1. é…ç½®é˜²ç«å¢™

```bash
# Ubuntuä½¿ç”¨ufw
ufw allow 22/tcp
ufw allow 80/tcp
ufw allow 443/tcp
ufw enable

# æŸ¥çœ‹çŠ¶æ€
ufw status
```

### 2. ç¦ç”¨root SSHç™»å½•ï¼ˆæ¨èï¼‰

```bash
# åˆ›å»ºæ–°ç”¨æˆ·
adduser deploy
usermod -aG sudo deploy

# é…ç½®SSH
nano /etc/ssh/sshd_config

# ä¿®æ”¹ä»¥ä¸‹é…ç½®
PermitRootLogin no
PasswordAuthentication no  # ä½¿ç”¨å¯†é’¥ç™»å½•

# é‡å¯SSH
systemctl restart sshd
```

### 3. é…ç½®fail2banï¼ˆé˜²æ­¢æš´åŠ›ç ´è§£ï¼‰

```bash
# å®‰è£…fail2ban
apt install -y fail2ban

# å¯åŠ¨æœåŠ¡
systemctl start fail2ban
systemctl enable fail2ban
```

### 4. å®šæœŸå¤‡ä»½

```bash
# åˆ›å»ºå¤‡ä»½è„šæœ¬
nano /opt/backup.sh
```

å†…å®¹ï¼š
```bash
#!/bin/bash
BACKUP_DIR="/opt/backups"
DATE=$(date +%Y%m%d_%H%M%S)

# åˆ›å»ºå¤‡ä»½ç›®å½•
mkdir -p $BACKUP_DIR

# å¤‡ä»½æ•°æ®åº“
docker-compose -f /opt/sf-express/docker-compose.yml --env-file /opt/sf-express/.env.production exec -T db mysqldump -u root -p${MYSQL_ROOT_PASSWORD} express_tracking > $BACKUP_DIR/db_$DATE.sql

# å¤‡ä»½ä¸Šä¼ æ–‡ä»¶
tar -czf $BACKUP_DIR/uploads_$DATE.tar.gz /opt/sf-express/uploads

# åˆ é™¤7å¤©å‰çš„å¤‡ä»½
find $BACKUP_DIR -name "*.sql" -mtime +7 -delete
find $BACKUP_DIR -name "*.tar.gz" -mtime +7 -delete
```

è®¾ç½®å®šæ—¶å¤‡ä»½ï¼š
```bash
# æ·»åŠ æ‰§è¡Œæƒé™
chmod +x /opt/backup.sh

# æ·»åŠ å®šæ—¶ä»»åŠ¡ï¼ˆæ¯å¤©å‡Œæ™¨3ç‚¹å¤‡ä»½ï¼‰
crontab -e
0 3 * * * /opt/backup.sh
```

---

## ç›‘æ§å’Œç»´æŠ¤

### 1. æŸ¥çœ‹æœåŠ¡çŠ¶æ€

```bash
# Dockeréƒ¨ç½²
docker-compose --env-file .env.production ps
docker-compose --env-file .env.production logs -f app

# ç›´æ¥éƒ¨ç½²
systemctl status sf-express
journalctl -u sf-express -f
```

### 2. æŸ¥çœ‹èµ„æºä½¿ç”¨

```bash
# æŸ¥çœ‹CPUå’Œå†…å­˜
htop

# æŸ¥çœ‹ç£ç›˜ä½¿ç”¨
df -h

# æŸ¥çœ‹Dockerèµ„æºä½¿ç”¨
docker stats
```

### 3. æ—¥å¿—ç®¡ç†

```bash
# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
tail -f /opt/sf-express/logs/app.log

# æŸ¥çœ‹Nginxæ—¥å¿—
tail -f /opt/sf-express/logs/nginx/access.log
tail -f /opt/sf-express/logs/nginx/error.log

# æ¸…ç†æ—§æ—¥å¿—
find /opt/sf-express/logs -name "*.log" -mtime +30 -delete
```

### 4. æ€§èƒ½ä¼˜åŒ–

```bash
# è°ƒæ•´Dockerèµ„æºé™åˆ¶
# ç¼–è¾‘docker-compose.ymlï¼Œæ·»åŠ èµ„æºé™åˆ¶
services:
  app:
    deploy:
      resources:
        limits:
          cpus: '2'
          memory: 2G
        reservations:
          cpus: '1'
          memory: 1G
```

---

## å¸¸è§é—®é¢˜

### 1. æœåŠ¡æ— æ³•å¯åŠ¨

```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tlnp | grep :8000

# æŸ¥çœ‹Dockeræ—¥å¿—
docker-compose --env-file .env.production logs

# æ£€æŸ¥é…ç½®æ–‡ä»¶
cat .env.production
```

### 2. æ•°æ®åº“è¿æ¥å¤±è´¥

```bash
# æ£€æŸ¥MySQLçŠ¶æ€
docker-compose --env-file .env.production exec db mysqladmin ping

# è¿›å…¥æ•°æ®åº“å®¹å™¨
docker-compose --env-file .env.production exec db mysql -u root -p

# æ£€æŸ¥ç½‘ç»œ
docker network ls
docker network inspect sf-express_express-tracking-network
```

### 3. æ— æ³•è®¿é—®ç½‘ç«™

```bash
# æ£€æŸ¥é˜²ç«å¢™
ufw status

# æ£€æŸ¥NginxçŠ¶æ€
docker-compose --env-file .env.production exec nginx nginx -t

# æ£€æŸ¥å®‰å…¨ç»„è§„åˆ™ï¼ˆé˜¿é‡Œäº‘æ§åˆ¶å°ï¼‰
```

### 4. SSLè¯ä¹¦é—®é¢˜

```bash
# éªŒè¯è¯ä¹¦
openssl x509 -in /opt/sf-express/docker/nginx/ssl/cert.pem -text -noout

# æµ‹è¯•SSLè¿æ¥
openssl s_client -connect yourdomain.com:443
```

### 5. å†…å­˜ä¸è¶³

```bash
# æ·»åŠ swapç©ºé—´
fallocate -l 2G /swapfile
chmod 600 /swapfile
mkswap /swapfile
swapon /swapfile

# æ°¸ä¹…ç”Ÿæ•ˆ
echo '/swapfile none swap sw 0 0' >> /etc/fstab
```

---

## å¿«é€Ÿå‘½ä»¤å‚è€ƒ

### Dockeréƒ¨ç½²å¸¸ç”¨å‘½ä»¤

```bash
# å¯åŠ¨æœåŠ¡
docker-compose --env-file .env.production up -d

# åœæ­¢æœåŠ¡
docker-compose --env-file .env.production down

# é‡å¯æœåŠ¡
docker-compose --env-file .env.production restart

# æŸ¥çœ‹æ—¥å¿—
docker-compose --env-file .env.production logs -f

# è¿›å…¥å®¹å™¨
docker-compose --env-file .env.production exec app bash

# é‡æ–°æ„å»º
docker-compose --env-file .env.production up -d --build

# æŸ¥çœ‹èµ„æºä½¿ç”¨
docker stats
```

### ç›´æ¥éƒ¨ç½²å¸¸ç”¨å‘½ä»¤

```bash
# å¯åŠ¨æœåŠ¡
systemctl start sf-express

# åœæ­¢æœåŠ¡
systemctl stop sf-express

# é‡å¯æœåŠ¡
systemctl restart sf-express

# æŸ¥çœ‹çŠ¶æ€
systemctl status sf-express

# æŸ¥çœ‹æ—¥å¿—
journalctl -u sf-express -f
```

---

## è®¿é—®åœ°å€

éƒ¨ç½²å®Œæˆåï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ï¼š

- **å‰å°æŸ¥è¯¢**: http://your_domain.com æˆ– http://your_server_ip
- **ç®¡ç†åå°**: http://your_domain.com/admin/login.html
- **APIæ–‡æ¡£**: http://your_domain.com:8000/docs
- **å¥åº·æ£€æŸ¥**: http://your_domain.com:8000/health

**é»˜è®¤ç®¡ç†å‘˜è´¦å·**ï¼š
- ç”¨æˆ·å: admin
- å¯†ç : admin123

**é‡è¦**ï¼šé¦–æ¬¡ç™»å½•åè¯·ç«‹å³ä¿®æ”¹å¯†ç ï¼

---

## ä¸‹ä¸€æ­¥

1. âœ… ä¿®æ”¹é»˜è®¤ç®¡ç†å‘˜å¯†ç 
2. âœ… é…ç½®çœŸå®çš„SSLè¯ä¹¦
3. âœ… è®¾ç½®å®šæœŸå¤‡ä»½
4. âœ… é…ç½®ç›‘æ§å‘Šè­¦
5. âœ… ä¼˜åŒ–æ€§èƒ½å‚æ•°
6. âœ… æµ‹è¯•æ‰€æœ‰åŠŸèƒ½

---

**éƒ¨ç½²å®Œæˆï¼** ğŸ‰

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æ—¥å¿—æˆ–è”ç³»æŠ€æœ¯æ”¯æŒã€‚
