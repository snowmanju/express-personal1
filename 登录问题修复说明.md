# ç™»å½•é—®é¢˜ä¿®å¤è¯´æ˜

## ğŸ› é—®é¢˜æè¿°

ä½¿ç”¨ç”¨æˆ·å `admin` å’Œå¯†ç  `admin123` ç™»å½•åå°æ—¶ï¼Œæç¤º"ç™»å½•å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•"ã€‚

## ğŸ” é—®é¢˜è¯Šæ–­

### è¯Šæ–­ç»“æœ

1. âœ… **æ•°æ®åº“æ£€æŸ¥**: adminç”¨æˆ·å­˜åœ¨ï¼Œå¯†ç å“ˆå¸Œæ­£ç¡®
2. âœ… **å¯†ç éªŒè¯**: å¯†ç éªŒè¯åŠŸèƒ½æ­£å¸¸
3. âŒ **APIè·¯å¾„**: å‰ç«¯è°ƒç”¨çš„APIè·¯å¾„é”™è¯¯

### è¯¦ç»†åˆ†æ

è¿è¡Œè¯Šæ–­è„šæœ¬ `python test_admin_login.py` å‘ç°ï¼š

```
[1/3] æ£€æŸ¥æ•°æ®åº“ä¸­çš„ç®¡ç†å‘˜ç”¨æˆ·...
âœ“ æ‰¾åˆ° 1 ä¸ªç®¡ç†å‘˜ç”¨æˆ·:
  - ID: 1, ç”¨æˆ·å: admin, åˆ›å»ºæ—¶é—´: 2026-01-27 20:14:58

[2/3] æµ‹è¯•ç™»å½•API...
HTTPçŠ¶æ€ç : 404  âŒ Not Found

[3/3] æµ‹è¯•å¯†ç å“ˆå¸ŒéªŒè¯...
âœ“ æ‰¾åˆ°ç”¨æˆ·: admin
âœ“ å¯†ç éªŒè¯æˆåŠŸ
```

**é—®é¢˜æ ¹å› **: å‰ç«¯è°ƒç”¨çš„APIè·¯å¾„ä¸æ­£ç¡®

## ğŸ”§ é—®é¢˜æ ¹å› 

### APIè·¯ç”±é…ç½®

åœ¨ `app/api/v1/api.py` ä¸­ï¼Œauthè·¯ç”±è¢«æ³¨å†Œåœ¨ `/admin` å‰ç¼€ä¸‹ï¼š

```python
# åŒ…å«è®¤è¯ç›¸å…³è·¯ç”±
api_router.include_router(auth.router, prefix="/admin", tags=["admin", "auth"])
```

### æ­£ç¡®çš„APIè·¯å¾„

- âŒ **é”™è¯¯è·¯å¾„**: `/api/v1/auth/login`
- âœ… **æ­£ç¡®è·¯å¾„**: `/api/v1/admin/login`

### å‰ç«¯ä»£ç é—®é¢˜

åœ¨ `static/admin/login_tech.html` ä¸­ï¼Œä½¿ç”¨äº†é”™è¯¯çš„APIè·¯å¾„ï¼š

```javascript
// âŒ é”™è¯¯
const response = await fetch('/api/v1/auth/login', {
    method: 'POST',
    // ...
});
```

## âœ… è§£å†³æ–¹æ¡ˆ

### ä¿®æ”¹æ–‡ä»¶

`static/admin/login_tech.html` å’Œ `static/admin/login.html`

### ä¿®æ”¹å†…å®¹

```javascript
// âœ… æ­£ç¡®
const response = await fetch('/api/v1/admin/login', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
    },
    body: JSON.stringify({
        username: username,
        password: password
    })
});
```

## ğŸ“Š ä¿®å¤å‰åå¯¹æ¯”

### ä¿®å¤å‰

```
ç”¨æˆ·è¾“å…¥: admin / admin123
å‰ç«¯è°ƒç”¨: POST /api/v1/auth/login
æœåŠ¡å™¨å“åº”: 404 Not Found âŒ
å‰ç«¯æ˜¾ç¤º: "ç™»å½•å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•"
```

### ä¿®å¤å

```
ç”¨æˆ·è¾“å…¥: admin / admin123
å‰ç«¯è°ƒç”¨: POST /api/v1/admin/login
æœåŠ¡å™¨å“åº”: 200 OK âœ…
è¿”å›æ•°æ®: {
  "access_token": "eyJhbGci...",
  "token_type": "bearer"
}
å‰ç«¯æ˜¾ç¤º: "ç™»å½•æˆåŠŸï¼æ­£åœ¨è·³è½¬..."
```

## ğŸ§ª æµ‹è¯•éªŒè¯

### æµ‹è¯•æ­¥éª¤

1. è®¿é—® http://localhost:8000/admin/login.html
2. è¾“å…¥ç”¨æˆ·å: `admin`
3. è¾“å…¥å¯†ç : `admin123`
4. ç‚¹å‡»"ç™»å½•"æŒ‰é’®

### é¢„æœŸç»“æœ

- âœ… æ˜¾ç¤º"ç™»å½•æˆåŠŸï¼æ­£åœ¨è·³è½¬..."
- âœ… è‡ªåŠ¨è·³è½¬åˆ°ç®¡ç†ä»ªè¡¨æ¿
- âœ… Tokenä¿å­˜åˆ°localStorage

### æµ‹è¯•è„šæœ¬

è¿è¡Œ `python test_admin_login.py` éªŒè¯ï¼š

```
[2/3] æµ‹è¯•ç™»å½•API...
HTTPçŠ¶æ€ç : 200

âœ“ ç™»å½•æˆåŠŸï¼
  - access_token: eyJhbGci...
  - token_type: bearer
```

## ğŸ“ ç›¸å…³APIç«¯ç‚¹

### è®¤è¯ç›¸å…³API

| ç«¯ç‚¹ | æ–¹æ³• | è¯´æ˜ |
|------|------|------|
| `/api/v1/admin/login` | POST | ç®¡ç†å‘˜ç™»å½• |
| `/api/v1/admin/logout` | POST | ç®¡ç†å‘˜ç™»å‡º |
| `/api/v1/admin/me` | GET | è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯ |
| `/api/v1/admin/change-password` | POST | ä¿®æ”¹å¯†ç  |

### å®Œæ•´URL

- ç™»å½•: `http://localhost:8000/api/v1/admin/login`
- ç™»å‡º: `http://localhost:8000/api/v1/admin/logout`
- ç”¨æˆ·ä¿¡æ¯: `http://localhost:8000/api/v1/admin/me`

## ğŸ” ç™»å½•å‡­è¯

### é»˜è®¤ç®¡ç†å‘˜è´¦æˆ·

- **ç”¨æˆ·å**: `admin`
- **å¯†ç **: `admin123`
- **åˆ›å»ºæ—¶é—´**: 2026-01-27 20:14:58

### å¦‚ä½•é‡ç½®å¯†ç 

å¦‚æœå¿˜è®°å¯†ç ï¼Œå¯ä»¥é‡æ–°åˆ›å»ºç”¨æˆ·ï¼š

```bash
# 1. åˆ é™¤ç°æœ‰ç”¨æˆ·ï¼ˆåœ¨MySQLä¸­ï¼‰
mysql -u root -p
USE express_tracking;
DELETE FROM admin_users WHERE username='admin';
EXIT;

# 2. é‡æ–°åˆ›å»ºç”¨æˆ·
python create_admin_user.py admin æ–°å¯†ç 
```

## ğŸ¯ å…¶ä»–ç™»å½•é¡µé¢

### éœ€è¦åŒæ­¥ä¿®æ”¹çš„æ–‡ä»¶

å¦‚æœæœ‰å…¶ä»–ç™»å½•é¡µé¢ä½¿ç”¨äº†é”™è¯¯çš„APIè·¯å¾„ï¼Œä¹Ÿéœ€è¦ä¿®æ”¹ï¼š

1. `static/admin/login_old.html` - æ—§ç‰ˆç™»å½•é¡µé¢ï¼ˆå¦‚æœä½¿ç”¨ï¼‰
2. ä»»ä½•è‡ªå®šä¹‰çš„ç™»å½•é¡µé¢

### æœç´¢å’Œæ›¿æ¢

åœ¨æ‰€æœ‰HTMLæ–‡ä»¶ä¸­æœç´¢ï¼š
```
/api/v1/auth/login
```

æ›¿æ¢ä¸ºï¼š
```
/api/v1/admin/login
```

## ğŸš€ éªŒè¯æ­¥éª¤

### 1. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜

- æŒ‰ `Ctrl+Shift+Delete`
- æ¸…é™¤ç¼“å­˜å’ŒCookie
- æˆ–ä½¿ç”¨æ— ç—•æ¨¡å¼æµ‹è¯•

### 2. æµ‹è¯•ç™»å½•æµç¨‹

1. è®¿é—®ç™»å½•é¡µé¢
2. è¾“å…¥ admin / admin123
3. ç‚¹å‡»ç™»å½•
4. éªŒè¯æ˜¯å¦æˆåŠŸè·³è½¬

### 3. æ£€æŸ¥å¼€å‘è€…å·¥å…·

æŒ‰ `F12` æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼š

- **Networkæ ‡ç­¾**: æŸ¥çœ‹APIè¯·æ±‚
  - åº”è¯¥çœ‹åˆ° `POST /api/v1/admin/login`
  - çŠ¶æ€ç åº”è¯¥æ˜¯ `200`
  
- **Consoleæ ‡ç­¾**: æŸ¥çœ‹é”™è¯¯ä¿¡æ¯
  - ä¸åº”è¯¥æœ‰é”™è¯¯

- **Applicationæ ‡ç­¾**: æŸ¥çœ‹å­˜å‚¨
  - localStorageåº”è¯¥æœ‰ `admin_token`

## ğŸ“‹ æ€»ç»“

### é—®é¢˜

å‰ç«¯ç™»å½•é¡µé¢ä½¿ç”¨äº†é”™è¯¯çš„APIè·¯å¾„ `/api/v1/auth/login`ï¼Œå¯¼è‡´404é”™è¯¯ã€‚

### åŸå› 

authè·¯ç”±è¢«æ³¨å†Œåœ¨ `/admin` å‰ç¼€ä¸‹ï¼Œæ­£ç¡®è·¯å¾„åº”è¯¥æ˜¯ `/api/v1/admin/login`ã€‚

### è§£å†³

ä¿®æ”¹å‰ç«¯ç™»å½•é¡µé¢çš„APIè°ƒç”¨è·¯å¾„ä¸º `/api/v1/admin/login`ã€‚

### ç»“æœ

âœ… ç™»å½•åŠŸèƒ½ç°åœ¨æ­£å¸¸å·¥ä½œ
âœ… ç”¨æˆ·å¯ä»¥æˆåŠŸç™»å½•åå°ç®¡ç†ç³»ç»Ÿ
âœ… Tokenæ­£ç¡®ä¿å­˜å’Œä½¿ç”¨

---

**ä¿®å¤æ—¶é—´**: 2026-01-27  
**ä¿®å¤æ–‡ä»¶**: `static/admin/login_tech.html`, `static/admin/login.html`  
**æµ‹è¯•çŠ¶æ€**: âœ… é€šè¿‡  
**ç™»å½•å‡­è¯**: admin / admin123
